---
layout: post
title: MVC架构模式，及其延伸MVP和MVVM
category: 技术
tags: DesignPattern MVC
keywords: 
description: 
---


###MVC架构模式

![mvc](https://raw.githubusercontent.com/paranoidq/paranoidq.github.io/master/public/img/posts/mvc/1.jpg)

```
View: 提供用户操作界面和显示

Model: 提供程序核心数据功能：数据访问、处理等

Controller: 业务逻辑，请求转发，调用Mode和View完成用户的需求

-   很多文章中，认为Controller负责处理业务逻辑，我认为这不够准确。核心逻辑因交由Model层完成，而Controller应该负责的包括：

    1. 转发请求到其他的Controller
    2. 传递用户参数到合适的Model 
    3. `组装拼接`Model层的核心功能，从而完成业务逻辑
    4. 反馈给view层相应的数据和视图名称（ModelAndView），以供渲染（ViewResolver）

```

###两种交互方式

通过view接受指令，传递给controller（大多数springMVC的web站点的方式还是需要通过view层的用户操作来传递业务逻辑的）

![mvc-1](http://image.beekka.com/blog/2015/bg2015020106.png)

直接通过controller接受input（RPC?）

![mvc-2](http://image.beekka.com/blog/2015/bg2015020107.png)



###MVC模式优点

1. 低耦合
 - 视图和业务分离，允许改变程序的数据层业务逻辑
 - `实际上,controller和view还是依赖于model层的，这点在springMVC中体现的很明显，model改变了，view和controller层也需要作出相应地调整`
 
2. 高重用
 - 同一模型和业务逻辑可以适用于不同的前端（web、pc、wap），只需要修改view

3. 快速部署
4. 易于进行UT（单元测试）
5. 可维护

###MVC模式的缺陷

1. Control logic can get overly complex. 控制器会变得复杂，很多人在Struts的Action控制器中写业务代码已经变得很常见，所有的操作都在action中，有的action都几乎上千行了.

2. Controllers can become dependent on information holders' contents.控制器变得依赖信息数据中心或数据库了，控制器做很多事情，意味着领域对象就做很少事情，控制器最后不是只会做什么，决定战略性的事情，也和怎么做，如何实现等战术问题耦合。

3. Objects can become coupled indirectly through the actions of their controller. 对象将间接地通过控制器的action耦合在一起，一个对象在控制器中查询获得，然后复制给另外一个对象，这两个对象就耦合在一起。

4. The only interesting work is done in the controller.唯一有趣的工作是做控制器，Responsibilities职责被吸进控制器对象，只将一些行为留给角色模型完成，重要的事情都集中在控制器中了。


####反驳

1. “很多人在Struts的Action控制器中写业务代码”，
只能归咎于2点。
 - 写代码的人“修炼”不够。`不能理解高内聚低耦合（High cohesion and low coupling[dependency]）的OO思想主旨``
 - 项目负责人放任自流。导致代码混乱。
 - `Action和SpringMVC中的Controller一样，应该更多负责转发，核心功能交由model完成`

2. “控制器变得依赖信息数据中心或数据库”
 - 现在的MVC应该大概都再用spring这样的IOC容器再对控制器进行分层，诸如service层dao层之类，说“依赖”，也是应该service和dao之间的依赖。而且这种依赖是和需求相关的，也就是和业务逻辑相关的，个人感觉也是一种“合理的存在”。
 - `个人体会，SpringMVC中，View和Controller确实对Model的一些变量设置有依赖，不过这个应该可以通过统一管理控制依赖的扩散`

3. “对象将间接地通过控制器的action耦合在一起”
 - 这个“缺点”到很客观。不过，作为开发整个项目的人来说，“构架师制定框架，程序员去实现业务逻辑“是“完美的结构”。
 - 同上，确实产生耦合，这点在SpringMVC中

###SpringMVC的架构

![spring-mvc](http://sishuok.com/forum/upload/2012/7/14/529024df9d2b0d1e62d8054a86d866c9__1.JPG)

- 这里model和view不直接交互，而是通过controller进行处理，将model中的数据注入到view中
- 返回的ModelAndView表示模型数据和逻辑视图名



###MVP
![mvp](http://image.beekka.com/blog/2015/bg2015020109.png)

1. 各部分之间的通信，都是双向的。
2. `View 与 Model 不发生联系`，都通过 Presenter 传递。
3. View 非常薄，不部署任何业务逻辑，称为"被动视图"（Passive View），即没有任何主动性，而 Presenter非常厚，所有逻辑都部署在那里。

###MVVM架构模式
![mvvm](http://image.beekka.com/blog/2015/bg2015020110.png)

- 唯一的区别是，它采用双向绑定（data-binding）：View的变动，自动反映在 ViewModel，反之亦然。Angular 和 Ember 都采用这种模式。用数据“绑定”的形式让数据更新的事件不需要开发人员手动去编写特殊用例，而是自动地双向同步.
- MVVM在概念上是真正将页面与数据逻辑分离的模式，它把数据绑定工作放到一个JS里去实现，而这个JS文件的主要功能是完成数据的绑定，即把model绑定到UI的元素上。
- 有人做过测试：使用Angular（MVVM）代替Backbone（MVC）来开发，代码可以减少一半。

###参考

[1] [http://www.ruanyifeng.com/blog/2007/11/mvc.html](http://www.ruanyifeng.com/blog/2007/11/mvc.html)

[2] [http://www.ruanyifeng.com/blog/2015/02/mvcmvp_mvvm.html](http://www.ruanyifeng.com/blog/2015/02/mvcmvp_mvvm.html)

[3] [http://www.jdon.com/38448] (http://www.jdon.com/38448)

[4] [http://www.zhihu.com/question/20148405](http://www.zhihu.com/question/20148405)