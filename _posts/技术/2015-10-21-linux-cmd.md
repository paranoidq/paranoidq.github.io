---
layout: post
title: Liunx服务器useful command
category: 技术
tags: Linux
keywords: 
description: 
---

###查看Linux服务器状况

####CPU

主要通过/proc文件夹下面的文件来获取

```
# 获取CPU个数
cat /proc/cpuinfo | grep "physical id" | sort | uniq | wc -l

#获取CPU core个数
cat /proc/cpuinfo | grep "cpu cores" | uniq

#获取逻辑CPU个数 = CPU个数 * cores
cat /proc/cupinfo | grep "processor" | wc -l

```


####Memory

```
# 查看内存
free -m # 以MB的方式显示

total   used    free    shared      buffers     cached
3949    1397    2551    0           268         917
-/+ buffers/cached      211        3737
Swap:   8001       0        8001

```

- total：总内存
- used：已使用
- free：空闲
- shared: 多个进程共享内存
- buffers：buffer cache 和 cached page cache: 磁盘缓存
- -buffers/cached：(已用内存) = used - buffers - cached
- +buffers/cached：(`程序`可用内存) = free + buffers + cached

注：

- buffer 和 cached 对操作系统来讲属于被使用的部分，但是程序可以挪用他们，因此程序可用内存需要算上这两个
- Linux系统内存是拿来用的，不满时不会使用到swap分区（这点和Windows不同，无论何时都会使用硬盘交换文件来读）。因此`如果swap没有被使用，那么就不用担心内存小。如果经常看到swap被使用，就需要考虑增加物理内存了——这是判断linux内存是否够用的标准`


####Disk

```
# 查看硬盘分区
fdisk -l

# 查看fs的硬盘占用情况
df -h

# 查看硬盘IO的性能
iostat -d -x -k 1 10 ???

# 查看目录大小
du -sh /data

找出占用空间最多的文件或目录前十
du -cks * | sort -rn | head -n 10


```


####Linux Load

```
# 动态反应系统负载状况
top

# 过去1min、5min、15min内进程队列的平均进程数量
uptime

# 可以查看系统当前有哪些用户，占用哪些终端
w

# 
vmstat

```

- uptime输出的三个load average值一般不能大于系统逻辑CPU的个数，如果长期大于，则表明CPU过于繁忙，系统负载较高


####整体性能

vmstat [采样时间间隔/s] [采样次数]

```
vmstat 1 4
```

- procs
    + r: 等待运行的进程数
    + b: 处于非中断睡眠状态的进程数
- memory: 
    + swpd: 虚拟内存使用情况（KB）
    + free: 空闲内存
    + buff: 被用来作为缓存的内存
- swap：
    + si: 从磁盘交换到内存的页数（KB/s）
    + so: 从内存交换到磁盘的页数（-）
- io:
    + bi: 发送到块设备的块数（块/s）
    + bo: 从块设备接收的块数
- system:
    + in: 每秒的中断数，包括时钟中断
    + cs: 每秒的上下文切换次数
- cpu: (按CPU使用的百分比时间显示)
    + us: cpu用户模式使用时间
    + sy: cpu系统模式使用时间
    + id: cpu闲置时间

标准状况：r < 5 和 b ·= 0

如果r经常大于4，id经常少于50, | usr%+sy% > 85% ，则表示系统的性能比较糟糕。


#### 其他查看命令

```
# 查看内核
uname -a

# 简化版
uname -r

# 查看发行版信息

lsb_release -a

# 查看载入的模块(用lsmod查看lvs模块是否已经载入)
lsmod | grep ip_vs


# 查看系统是否64位
# 1. 查找 /lib64目录
ls -lF / | grep /$ | grep lib64

# 2. 通过file判断文件是32或64位
file /sbin/init

```